---
title: 'Lab Exercise #1'
author: "Marivic T. Amuan"
date: "2024-02-08"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
PACKAGES
```{r}
library(rvest)
library(dplyr)
library(polite)
library(stringr)
library(httr)

url <- "https://www.amazon.com.au/gp/bestsellers/beauty/5150070051/ref=zg_bs_nav_beauty_1"

session <- bow(url, user_agent = "Educational Purposes")
session
``` 
SCRAPING 100 PRODUCTS
Scraping Thirty (30) Products - 1st Session
```{r}
#1st Session
session <- session ("https://www.amazon.com.au/gp/bestsellers/beauty/ref=zg_bs_nav_beauty_0")

productNames <- session %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name <- productNames[1:30]
name

#dataframing my datas so i can bind them later on.
df_1 <- data.frame(Products = name)
df_1


#2st Session
session_2 <- session ("https://www.amazon.com.au/gp/bestsellers/beauty/5150108051/ref=zg_bs_nav_beauty_2_5150070051")

productNames_2 <- session_2 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_2 <- productNames_2[1:30]
name_2

#dataframing my datas so i can bind them later on.
df_2 <- data.frame(Products = name_2)
df_2


#Scraping Thirty (30) Products - 3rd Session
session_3 <- session ("https://www.amazon.com.au/gp/bestsellers/beauty/5150080051/ref=zg_bs_nav_beauty_2_5150067051")

productNames_3 <- session_3 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
splitNames <- unlist(strsplit(productNames_3, "/n"))

name_3 <- productNames_3[1:30]
name_3

#dataframing my datas so i can bind them later on.
df_3 <- data.frame(Products = name_3)
df_3


#Scraping Thirty (30) Products - 4th Session
session_4 <- session ("https://www.amazon.com.au/gp/bestsellers/beauty/5150297051/ref=zg_bs_nav_beauty_2_5150070051")

productNames_4 <- session_4 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_4 <- productNames_4[1:10]
name_4


#Dataframing my datas so i can bind them later on.
df_4 <- data.frame(Products = name_4)
df_4


#Combining each data, using rbind.
combinedDataframe <- rbind(df_1,df_2,df_3,df_4)
combinedDataframe


#CSV Files
write.csv(combinedDataframe, "first_100_products.csv")
read.csv("first_100_products.csv")



#1st 10 Products Session - PRICE, RATINGS, and REVIEWS
#1st Session - 10 PRODUCTS
productFirstSession <- session %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()

productFirstSession_1 <- productFirstSession[1:10]
productFirstSession_1



#1st Session - 10 PRICE
priceFirstSession <- session %>%
  html_nodes("span.p13n-sc-price") %>%
  html_text()

priceFirstSession_1 <- priceFirstSession[1:10]
priceFirstSession_1
 
  

#1st Session - 10 RATINGS
ratingFirstSession <- session %>%
  html_nodes("span.a-size-small") %>%
  html_text()

ratingFirstSession_1 <- ratingFirstSession[1:10]
ratingFirstSession_1


#1st Session - 10 REVIEWS
reviewFirstSession <- session %>%
  html_nodes("span.a-icon-alt") %>%
  html_text()

reviewFirstSession_1 <- reviewFirstSession[1:10]
reviewFirstSession_1


#First DataFrame (20 Products, Price, Ratings, and Reviews)
firstDataframe <- data.frame(
  Products = productFirstSession_1,
  Price = priceFirstSession_1,
  Ratings = ratingFirstSession_1,
  Reviews = reviewFirstSession_1
)
firstDataframe


#CSV File
write.csv(firstDataframe, "first_session_ten_products.csv")
```

SCRAPING 100 PRODUCTS
Scraping Thirty (30) Products - 2nd Session
```{r}
session_5 <- session ("https://www.amazon.com.au/gp/bestsellers/computers/4913305051/ref=zg_bs_nav_computers_1")

productNames_5 <- session_5 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_5 <- productNames_5[1:30]
name_5

#dataframing my datas so i can bind them later on.
df_5<- data.frame(Products = name_5)
df_5


#Scraping Thirty (30) Products - 2nd Session
session_6 <- session ("https://www.amazon.com.au/gp/bestsellers/computers/4913305051/ref=zg_bs_pg_2_computers?ie=UTF8&pg=2")

productNames_6 <- session_6 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_6 <- productNames_6[1:30]
name_6


#Dataframing my datas so i can bind them later on.
df_6 <- data.frame(Products = name_6)
df_6

#Scraping Thirty (30) Products - 2nd Session
session_7 <- session ("https://www.amazon.com.au/gp/bestsellers/computers/4913322051/ref=zg_bs_nav_computers_2_4913305051")

productNames_7 <- session_7 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_7 <- productNames_7[1:30]
name_7


#Dataframing my datas so i can bind them later on.
df_7 <- data.frame(Products = name_7)
df_7

#Scraping Thirty (30) Products - 2nd Session
session_8 <- session ("https://www.amazon.com.au/gp/bestsellers/computers/4913410051/ref=zg_bs_nav_computers_3_4913408051")

productNames_8 <- session_8 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()
  
name_8 <- productNames_8[1:10]
name_8

#Dataframing my datas so i can bind them later on.
df_8 <- data.frame(Products = name_8)
df_8


combinedDataframe <- rbind(df_5,df_6,df_7,df_8)
combinedDataframe

#CSV Files
write.csv(combinedDataframe, "second_100_products.csv")
read.csv("second_100_products.csv")

#2nd 10 Products Session - PRICE, RATINGS, and REVIEWS
#2nd Session - 10 PRODUCTS

productSecondSession <- session_5 %>%
  html_nodes("div._cDEzb_p13n-sc-css-line-clamp-3_g3dy1") %>%
  html_text()

productSecondSession_1 <- productSecondSession[1:10]
productSecondSession_1


#2nd Session - 10 PRICE
priceSecondSession <- session_5 %>%
  html_nodes("span.p13n-sc-price") %>%
  html_text()

priceSecondSession_1 <- priceSecondSession[1:10]
priceSecondSession_1


#2nd Session - RATINGS 
ratingSecondSession <- session_5 %>%
  html_nodes("span.a-size-small") %>%
  html_text()

ratingSecondSession_1 <- ratingSecondSession[1:10]
ratingSecondSession_1


#2nd Session - 10 REVIEWS
reviewSecondSession <- session_5 %>%
  html_nodes("span.a-icon-alt") %>%
  html_text()

reviewSecondSession_1 <- reviewSecondSession[1:10]
reviewSecondSession_1

combinedDataframe_2 <- rbind(df_5,df_6,df_7,df_8)
combinedDataframe_2

#dataframe
secondDataframe <- data.frame(
  Products = productFirstSession_1,
  Price = priceFirstSession_1,
  Ratings = ratingFirstSession_1,
  Reviews = reviewFirstSession_1
)
secondDataframe

#CSV File
write.csv(firstDataframe, "second_session_ten_products.csv")
```

